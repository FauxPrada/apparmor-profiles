# AppArmor profile for hexchat IRC client
# Homepage: https://gitlab.com/krathalan/apparmor-profiles
# Copyright 2019 (C) krathalan; Licensed under GPLv3

#include <tunables/global>

profile hexchat /usr/bin/hexchat {
  #include <abstractions/base>
  #include <abstractions/fonts>
  #include <abstractions/gnome>

  # Spellchecking
  #include <abstractions/enchant>

  # Networking
  #include <abstractions/nameservice>
  #include <abstractions/openssl>
  /etc/ca-certificates/extracted/* r,

  # Mime
  /usr/share/mime/mime.cache r,
  owner /home/*/.local/share/mime/mime.cache r,

  # Icons and themes
  /usr/share/gtk-2.0/gtkrc r,
  /usr/share/icons/ r,
  /usr/share/icons/** r,
  owner /home/*/.gtkrc-2.0 r,
  owner /home/*/.local/share/icons/ r,
  owner /home/*/.local/share/icons/** r,

  # Config
  owner /home/*/.config/hexchat/ rw,
  owner /home/*/.config/hexchat/** rw,
  owner /home/*/.config/user-dirs.dirs r,

  # Fonts (from abstractions/fonts)
  owner /home/*/.cache/fontconfig/ rw,
  owner /home/*/.cache/fontconfig/** mrwl,

  # Silence unneeded permissions
  deny /usr/share/fonts/** w,
  deny /usr/share/pixmaps/ r,
  deny /var/lib/flatpak/** r,
  deny owner /home/*/ r,
}
