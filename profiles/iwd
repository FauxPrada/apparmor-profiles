# AppArmor profile for iwd NetworkManager backend
# Version of iwd profiled: 1.5
# Homepage: https://git.sr.ht/~krathalan/apparmor-profiles/
# Copyright 2019 (C) krathalan; Licensed under GPLv3

#include <tunables/global>

profile iwd /usr/lib/iwd/iwd {
  #include <abstractions/base>
  #include <abstractions/krathalans-hardening>

  capability net_admin,

  # Config
  owner /etc/iwd/{,**} r,

  # Device access
  owner /dev/rfkill rw,
  owner @{sys}/devices/** r,

  # Connection information (e.g. wifi passwords)
  owner /var/lib/iwd/ r,
  owner /var/lib/iwd/** rw,
}
