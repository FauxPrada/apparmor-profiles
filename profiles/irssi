# AppArmor profile for irssi IRC client
# Version of irssi profiled: 1.2.2
# Homepage: https://git.sr.ht/~krathalan/apparmor-profiles/
# Copyright 2019 (C) krathalan; Licensed under GPLv3

#include <tunables/global>

profile irssi /usr/bin/irssi {
  #include <abstractions/base>
  #include <abstractions/bash>
  #include <abstractions/krathalans-hardening>

  # Irssi has perl scripting
  #include <abstractions/perl>

  # Include user overrides for possible symlinked config files
  #include <local/irssi>

  # Networking
  #include <abstractions/krathalans-networking>

  @{system_share_dirs}/irssi/** r,

  # Config
  owner @{HOME}/.irssi/* rw,
  owner @{HOME}/.config/irssi/* rw,

  # Deny unnecessary permissions
  deny /etc/passwd r,
  deny /{,var/}run/systemd/userdb/ r,
}
